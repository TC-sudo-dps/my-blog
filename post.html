<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>載入中... | Leon's Blog</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <style>
        :root {
            --bg-color: #0f172a;
            --card-bg: #1e293b;
            --text-main: #f8fafc;
            --text-muted: #94a3b8;
            --primary-color: #00d2ff;
        }
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-main);
            line-height: 1.8;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 800px;
            margin: 60px auto;
            background: var(--card-bg);
            padding: 50px;
            border-radius: 20px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.05);
        }
        .back-link {
            display: inline-block;
            color: var(--primary-color);
            text-decoration: none;
            margin-bottom: 30px;
            font-weight: bold;
            transition: 0.3s;
        }
        .back-link:hover { opacity: 0.7; transform: translateX(-5px); }
        #post-content img { max-width: 100%; border-radius: 12px; margin: 20px 0; }
        #post-content h1, #post-content h2 { color: var(--primary-color); border-bottom: 1px solid #334155; padding-bottom: 10px; }
        #post-content pre { background: #000; padding: 20px; border-radius: 12px; overflow-x: auto; color: #adbac7; }
        #post-content code { background: rgba(0, 210, 255, 0.1); color: var(--primary-color); padding: 2px 6px; border-radius: 4px; }
    </style>
</head>
<body>
    <div class="container">
        <a href="/" class="back-link">← 返回文章列表</a>
        <article id="post-content">正在為您開啟時光機，讀取文章中...</article>
    </div>

    <script>
        async function fetchPost() {
            const urlParams = new URLSearchParams(window.location.search);
            const fileName = urlParams.get('f');
            if (!fileName) {
                window.location.href = '/';
                return;
            }

            try {
                // 從 GitHub 抓取指定的 Markdown 檔案
                const response = await fetch(`https://api.github.com/repos/TC-sudo-dps/my-blog/contents/posts/${fileName}`);
                const data = await response.json();
                
                // Base64 解碼 (處理中文亂碼問題)
                const markdown = decodeURIComponent(escape(atob(data.content)));
                
                // 使用 marked.js 將 Markdown 轉成 HTML
                document.getElementById('post-content').innerHTML = marked.parse(markdown);
                
                // 自動更新網頁標題
                const titleMatch = markdown.match(/^#\s+(.*)/) || markdown.match(/title:\s*"(.*)"/);
                if (titleMatch) document.title = titleMatch[1] + " | Leon's Blog";

            } catch (error) {
                document.getElementById('post-content').innerHTML = "<h1>抱歉！</h1><p>這篇文章消失在宇宙黑洞中了。</p>";
            }
        }
        fetchPost();
    </script>
</body>
</html>
